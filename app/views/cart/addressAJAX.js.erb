user = [];

name = document.getElementById('name').value;
user.push(name);
firstname = document.getElementById('Firstname').value;
user.push(firstname);
email = document.getElementById('email').value;
user.push(email);
street = document.getElementById('street').value;
user.push(street);
postalCode = document.getElementById('postalCode').value;
user.push(postalCode);
city = document.getElementById('city').value;
user.push(city);
postalCode = parseInt(postalCode);
realBtn = document.getElementById("nextBtnReal");

localStorage.setItem('user', JSON.stringify(user));


main = document.getElementById("address_title").parentElement;
main.setAttribute("id", "main");

error = document.getElementById("errorMsg");
error.firstElementChild.remove()
errorBox = document.createElement("div");
errorBox.setAttribute("id", "errorBox");
error.appendChild(errorBox);

function addError(el) {
  error.className = "";
  let p = document.createElement("p");
  let textNode = document.createTextNode(el);
  p.appendChild(textNode);
  errorBox.appendChild(p);
}

if(name.length ==0 || name.length>30){
  addError("Il semble y avoir une erreur avec votre nom.");
}

if(firstname.length == 0 || firstname.length > 30){
  addError("Il semble y avoir une erreur avec votre prénom.")
}

if(mailformat.test(email) == false){
  addError("Votre addresse e-mail semble ne pas avoir le bon format.");
}

if(street.length == 0 || street.length > 30){
  addError("Il semble y avoir un problème avec le nom de rue.")
}

if(postalCode == NaN || postalCode < 1000 || postalCode > 9999 || postalCode == undefined){
  addError("Nous livrons uniquement en Suisse pour l'instant. Désolé.")
}

if(city.length == 0 || city.length > 30){
  addError("Il semble y avoir un problème avec le nom de ville.")
}

if(error.firstElementChild.firstElementChild != null){
  main = document.getElementById("main");
  main.id ="";
} else {
  error.className="hidden";
  realBtn.click();
}
